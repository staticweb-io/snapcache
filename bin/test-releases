#!/usr/bin/env bash
set -euo pipefail

# Test releases against the oldest and newest supported PHP versions
parallel -j "${1:-$(nproc)}" --tagstring "{1} {2}" --line-buffer '
  echo "Testing {2} with {1}"
  PHP_PACKAGE="{1}" SNAPCACHE_PACKAGE="{2}" nix flake check --impure ./dev
' ::: php84 php81 ::: plugin pluginWpOrg
